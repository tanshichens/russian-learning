# 📱 手机访问配置指南

## 问题说明

手机访问提示"网络请求失败"是因为手机无法访问 `localhost:3001`。
`localhost` 只能在本机访问，手机需要使用电脑的局域网IP地址。

## ✅ 解决方案（已自动配置）

我已经为你配置了**智能API地址检测**功能：

- 电脑访问 `localhost:5173` → API使用 `localhost:3001`
- 手机访问 `192.168.1.100:5173` → API自动使用 `192.168.1.100:3001`

**无需额外配置！**

## 🚀 使用步骤

### 1. 获取电脑IP地址

在电脑上打开命令提示符，运行：
```bash
ipconfig
```

查找"无线局域网适配器 WLAN"或"以太网适配器"下的：
```
IPv4 地址 . . . . . . . . . . . . : 192.168.1.100
```

记下这个IP地址（例如：`192.168.1.100`）

### 2. 确保电脑和手机在同一WiFi

- 电脑连接WiFi：家里的WiFi
- 手机连接WiFi：同一个WiFi
- 必须是同一个网络！

### 3. 启动服务

双击：`启动服务.bat`

### 4. 手机访问

在手机浏览器输入：
```
http://192.168.1.100:5173
```
（把192.168.1.100替换成你的电脑IP）

### 5. 测试注册

- 点击"申请账号"
- 填写用户名和密码
- 提交
- 现在应该成功了！✅

## 🔧 如果还是失败

### 检查1：后端是否启动

在电脑浏览器访问：
```
http://localhost:3001/api/health
```

应该看到：
```json
{
  "status": "ok",
  "message": "俄语学习网站API运行中"
}
```

### 检查2：防火墙设置

Windows防火墙可能阻止了端口访问。

**方法1：临时关闭防火墙测试**
1. 打开Windows设置
2. 搜索"防火墙"
3. 临时关闭防火墙
4. 测试手机访问
5. 如果成功，说明是防火墙问题

**方法2：添加防火墙规则**

管理员身份运行PowerShell：
```powershell
# 允许端口3001（后端API）
New-NetFirewallRule -DisplayName "Russian Learning API" -Direction Inbound -LocalPort 3001 -Protocol TCP -Action Allow

# 允许端口5173（前端开发服务器）
New-NetFirewallRule -DisplayName "Russian Learning Frontend" -Direction Inbound -LocalPort 5173 -Protocol TCP -Action Allow
```

### 检查3：手机浏览器控制台

在手机上：
1. 访问网站
2. 尝试申请账号
3. 查看是否有错误提示

### 检查4：网络连通性

在电脑上测试手机是否能访问：

**从手机ping电脑**：
- 使用手机上的网络工具app
- Ping你的电脑IP
- 应该能ping通

## 🎯 完整测试流程

### 步骤1：电脑端准备
```bash
# 1. 获取IP
ipconfig
# 假设得到：192.168.1.100

# 2. 启动服务
双击：启动服务.bat

# 3. 验证后端
浏览器访问：http://localhost:3001/api/health
```

### 步骤2：手机端访问
```
1. 手机连接同一WiFi
2. 打开浏览器
3. 访问：http://192.168.1.100:5173
4. 点击"申请账号"
5. 填写：testmobile / test123
6. 提交申请
```

### 步骤3：电脑端审批
```
1. 电脑浏览器访问：http://localhost:5173
2. 用admin登录
3. 点击"用户管理"
4. 应该看到手机提交的testmobile申请 ✅
5. 点击✓批准
```

### 步骤4：手机端登录
```
1. 手机上点击"已有账号？返回登录"
2. 输入：testmobile / test123
3. 点击登录
4. 成功！可以访问单词库 ✅
```

## 🌐 不同网络场景

### 场景1：同一WiFi（推荐）
- ✅ 最简单
- ✅ 性能最好
- 使用：`http://电脑IP:5173`

### 场景2：不同网络
- 需要部署到公网服务器
- 使用域名访问
- 查看：`BACKEND-API-SETUP.md`

## 💡 快速诊断

如果手机注册失败，在手机浏览器按F12（如果支持）或查看：

**错误信息**：
- "网络请求失败" → 检查防火墙
- "CORS错误" → 后端CORS已配置为允许所有来源，应该不会有这个问题
- "超时" → 检查网络连接

**手机浏览器地址栏**：
- 应该是：`http://192.168.1.100:5173`
- 不是：`http://localhost:5173`（这个手机访问不了）

## 🔍 Debug技巧

### 电脑端查看API日志
后端服务器窗口会显示所有API请求：
```
POST /api/registration-requests 200 15ms
GET /api/registration-requests 200 5ms
```

### 手机端检查
1. 访问：`http://电脑IP:5173`
2. 打开浏览器开发者工具（某些手机浏览器支持）
3. 查看Network标签
4. 看API请求是否发送到正确地址

## ✅ 成功标志

当你看到：
- ✅ 手机上能打开网站
- ✅ 手机上能申请账号并提交成功
- ✅ 电脑上能看到手机的申请
- ✅ 批准后手机能登录

说明跨设备同步完美工作！🎉

## 📞 需要帮助？

如果还是不行，告诉我：
1. 电脑的IP地址是多少？
2. 手机访问时的完整错误信息？
3. 后端窗口显示了什么？
4. 电脑和手机是否在同一WiFi？

